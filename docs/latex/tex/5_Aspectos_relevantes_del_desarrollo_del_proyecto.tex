\capitulo{5}{Aspectos relevantes del desarrollo del proyecto}

Este apartado pretende recoger de manera breve los aspectos más interesantes del desarrollo del proyecto así como su justificación: decisiones que se han tomado, desarrollo, progreso general y problemas que surgieron durante toda la realización del proyecto.


\section{Inicio del proyecto}\label{inicio-proyecto}
Cuando llegó la hora de buscar proyecto, entre las  diferentes opciones disponibles estaba \emph{SWAPP}, una herramienta realizada años atrás en la universidad por un alumno que desarrolló una aplicación nativa en Android sobre el mismo tema.

 Desde el primer momento me llamo la atención el proyecto porque resultaba un aplicación que en un futuro podía tener un uso real. Además se trataba de tecnologías web con las cuales poder realizar una aplicación híbrida. Me pareció una idea fascinante, sobre todo porque desconocía plataformas como \emph{Cordova} o \emph{Phohegapp}. Está claro que el principal peso del proyecto se lo lleva la aplicación web, dado que es la parte fundamental y sobre la que se va a sustentar todo lo demás. Por lo que resultaba fundamental escoger un buen \emph{framework} web y estudiarlo de manera concienzuda.
 
  En consecuencia surge el primero de los debates, qué tipo de \emph{framework} usar. La multitud de opciones que existe en el mercado es realmente extensa.: una de las opciones a tener en cuenta para la elección de tu aplicación es comprobar que el \emph{framework} sigue recibiendo soporte actualmente (Por ejemplo github tiene 'escaparates' donde agrupa los \emph{frameworks}por tipos, algunos repositorios son \href{ https://github.com/showcases/web-application-frameworks/}{públicos}  y es posible saber la frecuencia con la que se actualizan). Además una de las mejores cosas del software libre es que puedes interactuar con los propios creadores  o desarrolladores de una tecnologías, abrir \emph{issues} en github y en la mayoría de  ocasiones recibes respuesta. 
  

  \section{Formación}\label{formacion}
Desde el primer momento se priorizó la formación por delante de todo ya que el proyecto requiere conocimientos de dos tipos: por una parte conocimientos web, y por otro lado conocimientos que eran totalmente desconocidos para el alumno como manejo de la parte del servidor, bases de datos NosQL o desarrollo de aplicaciones híbridas. 

Gracias a las nuevas tecnologías tan solo es necesario un ordenador y una buena conexión a internet para tener acceso a conocimiento infinito. Desde hace algunos años está en auge la formación online y las plataformas web que ofrecen cursos de diversos tipos. Existen numerosísimas plataformas \cite{elearning} de este estilo, una de las más conocidas es  \href{www.coursera.org}{Coursera}, que reúne cursos online masivos, abiertos y gratuitos (MOOCS). El curso fue recomendado por mi tutor, desde hace algún tiempo la visibilidad de la parte gratuita se ha reducido pudiendo solo acceder a partes limitadas de los contenidos. Es posible realizar el curso completo pero no obtener \emph{feedback} de otros usuarios ni tampoco subir a la plataforma los avances de código.

Por lo que en un primer momento se decidió realizar la siguiente especialización compuesta de seis cursos diferentes:

      
\begin{itemize}
	\item \emph{HTML, CSS y JavaScript}, una introducción al desarrollo web con las principales tecnologías. Qué es DOM y CSS.
	\item  \emph{Front-End Web UI Frameworks and Tools}, conocimiento de lo que es un framework web: Boostrap. También introducción a los preprocesadores Less, Sass.
	\item \emph{Front-End JavaScript Frameworks: AngularJS},  introducción y desarrollo con AngularJS.
	\item  \emph{Multiplatform Mobile App Development with Web Technologies}, desarrollo UI/UX, el framework Ionic como complemento a AngularJS para  crear aplicaciones hibridas con ayuda de Cordova.
	\item  \emph{Server-side Development with NodeJS},  lado del servidor con Node JS.
	\item  \emph{Full Stack Web Development Specialization Capstone}.
\end{itemize}


Los cursos pertenecen al curso \href{https://www.coursera.org/specializations/full-stack}{\emph{Full-stack web develompent}} y son bastante completos en lo que a materia se refiere. Resulta fundamental saber algo de inglés porque, en caso de no saber, se hacen bastante pesados.

Después además realicé algún que otro curso en español, en esta ocasión la plataforma elegida fue  \href{https://www.udemy.com/}{\emph{Udemy}}. El enfoque de esta web es totalmente diferente a la anterior, mientras que la que hago referencia en el párrafo anterior en su mayoría se ofrecen grades cursos de universidades y profesores de prestigio de todo el mundo, Udemy se centra más en personas 'normales' . Es decir, \emph{freelancers}  que tienen conocimientos de algún campo en concreto y realizan un curso de una materia específica y lo venden a los usuarios. Existen tanto cursos gratuitos, de una duración menor, como cursos de diferentes precios. En mi caso he realizado algunos gratuitos y otros de pago, a saber:  

\begin{itemize}
	\item \emph{Curso de Nodejs y Angular 2}: Aprende a desarrollar servicios RESTful (APIs) con NodeJS y MongoDB y a crear webs SPA con Angular2 y 4. \cite{curso1}
	\item  \emph{Introducción a Angular 4 - Instalación y componentes}: Aprende las bases de Angular4 desde cero y paso a paso. \cite{curso2}
	\item \emph{Introducción teórica a los frameworks de desarrollo Web}: Aprende los conceptos teóricos necesarios para empezar a trabajar con frameworks de desarrollo MVC. \cite{curso3}
\end{itemize}

La plataforma anterior también es muy didáctica, completa y accesible; además posee una característica que a mi parecer es fundamental: tienes contacto directo con el creador del curso que te resuelve dudas de código.

Para terminar recomiendo también las páginas web  \href{https://desarrolloweb.com/manuales/manual-angular-2.html}{\emph{Desarrollo Web }} \cite{desarrollo1} \cite{desarrollo2}, \href{http://academia-binaria.com/}{\emph{Academia binaria }} \cite{academia2}, \href{https://scotch.io/}{\emph{scotch.io }}  \cite{scotch1} y el manual oficial de \href{https://angular.io/docs/}{\emph{Angular }} .




 \section{Frameworks cliente}\label{cliente}
 
 \emph{AngularJs vs Angular } esta fue una de las dudas con las que más tiempo perdí al inicio del desarrollo y después de la fase de formación con la especialización de Coursera no sabía exactamente cuál de las dos escoger. Por una parte estaba la formación recibida en los seis cursos iniciales que todos fueron en AngularJS y por otra la inquietud del futuro ya que los frameworks evolucionan siempre a mejor y tarde o temprano los versiones iniciales se acaban quedando obsoletas. 
 
 Lo primero que hay que decir es que Angular no es la siguiente versión de AngularJS, sino que es un \underline{nuevo framework}, escrito desde cero y con conceptos y formas de trabajar completamente distintos. Angular utiliza un sistema de inyección de dependencias jerárquico impulsando su rendimiento de forma increíble.  Según algunos datos oficiales, Angular puede llegar a ser \textbf{5 veces más rápido} que la primera versión.  Vamos a conocer algunas de las características generales de porque finalmente llegué a escoger este nuevo framework. 
 
 \begin{enumerate}
	\item Angular está orientado a móviles y tiene mejor rendimiento.
	\item Angular ofrece más opciones a la hora de elegir lenguajes.
	\item Los controladores desaparecen haciendo ahora uso de componentes web, resulta más intuitivo y un estándar de futuro que todavía no encuentra soportado por todos los navegadores web pero en el futuro lo estará por lo que el rendimiento será todavía mayor.
	\item Angular usa directamente las propiedades de los elementos y los eventos estándar del DOM
	\item Su futuro es prometedor. 
	\item Una cosa curiosa: en varios años AngularJS tuvo unos 8500 \emph{commits} en github, en tan solo unos meses Angular lleva más de 7845 \emph{commits}.
\end{enumerate}
 
 Vamos a ver por ejemplo cómo han evolucionado los \underline{controladores} (Así se conocían en AngularJS) a los \underline{componentes} (Así se conocen en Angular) de una versión a otra.
 
 En angularJS:
 
 \lstset{breaklines=true, basicstyle=\footnotesize}
\begin{lstlisting}[frame=single]
<body ng-controller="PeliculasController as peli">  
  <h3>{{peli.data.titulo}}</h3>
  <h3 ng-bind="peli.data.titulo"></h3>
</body>  
<script type="text/javascript">  
(function (){
  angular
    .module('app')
    .controller('PeliculasController', PeliculasController);
 
  function PeliculasController() {
    var peli = this;
    peli.data= { id: 45, titulo: 'Una historia real' };
  }
})();
</script> 
\end{lstlisting}

En Angular:
 \lstset{breaklines=true, basicstyle=\footnotesize}
\begin{lstlisting}[frame=single]
import { Component } from 'angular2/core';
 
@Component({
  selector: 'pelicula',
  template: '<h2>{{pelicula.titulo}}</h2>'
})
export class PeliculaComponent {  
  public pelicula = { id: 45, titulo: 'Una historia real' };
}
\end{lstlisting}

Si podéis observar al inicio de la sección comencé haciendo referencia a \emph{Angular2} y \emph{AngularJS} pero ha medida que he avanzado simplemente he omitido el número. Podría parecer que lo he olvidado pero para nada es así, después del nacimiento de esa nueva versión que resultó ser un \emph{framework} en sí mismo que aprender desde cero, desde el equipo de desarrollo de Angular lo que se intentó es describir al \emph{framework} sin ningún tipo de numeración, simplemente existe un \emph{framework} y se van a aplicar modificaciones sobre él para mejorarlo, nada más. Para entender mejor esta ruptura AngularJS y Angular no son compatibles pero sí lo son las versiones posteriores. De hecho hace dos meses, en Abril, lanzaron  \emph{Angular  4.0 }  que posee cambios menores respecto de su versión anterior pero son totalmente compatibles.

\imagenflotante{resumen-angular4}{Características \emph{Angular}. Fuente:  \url{wikipedia.org/wiki/Angular.}}



Respecto al futuro de Angular en la última presentación se dijo  que podemos esperar una nueva versión ‘mayor’ cada seis meses, Angular 5 estará lista en Septiembre del 2017, la versión 6 en Marzo del 2018 y así sucesivamente. Está claro que todo proyecto de software que quiera avanzar a buena velocidad, en algún momento introducirá cambios que por desgracia no serán compatibles con versiones anteriores, forzándote a tocar tu código para actualizarte y quizás sea esa una de las necesidades de autoformación ya que todo está en constante cambio. 

Por supuesto cabe decir aquí que una no es mejor ni peor que la otra, AngularJS se convirtió en un framework extremadamente popular desde su lanzamiento \cite{angularmarket} y a día de hoy se siguen realizando aplicaciones web con este \emph{framework}. La comunidad de desarolladores que están detrás de su mantenimiento es enorme y es posible consultar dudas sin ningún tipo de problema. La apuesta por Angular es sin dudarlo una apuesta de futuro.


  \section{Tipo de base de datos}\label{base de datos}
  
  Otro de las disyuntivas sin lugar a dudas fue la elección de la base de datos. Mi conocimiento sobre bases de datos se limitaba a lo visto durante el grado en la universidad y lo aprendido durante mi estancia de prácticas, por lo que era suficiente para saber manejarme con una. Eso sí siempre había empleado \textbf{bases de datos SQL} o relacionales. Nada más comenzar a introducirme en el mundo de desarrollo web comencé a saber más sobre las bases de datos NoSQL. La diferencia conceptual entre SQL y NoSQL radica en que resuelven escenarios completamente diferentes y excluyentes el uno del otro; ya que para lo que resulta ideal SQL, no lo es NoSQL y viceversa. Aportada la idea principal vamos resumir las diferencias entre ambas de manera breve. 
  
  \begin{itemize}
    \item SQL permite combinar de forma eficiente diferentes tablas para extraer información relacionada, mientras que NoSQL no lo permite o muy limitadamente.
    \item NoSQL permite distribuir grandes cantidades de información; mientras que SQL facilita distribuir bases de datos relacionales.
    \item SQL permite gestionar los datos junto con las relaciones existentes entre ellos; en NoSQL no existe este tipo de utilidades.
    \item NoSQL permite un escalado horizontal sin problemas – por su capacidad de distribución; mientras que escalar SQL resulta más complicado.
   \end{itemize}
   
    Entre las recomendaciones que he podido recopilar de algunos blogs \cite{blog1} \cite{blog2}  estos son algunos de los entornos que \textbf{se recomiendan para usar} bases de datos NoSQL:
    
      \begin{itemize}
      \item Redes sociales: casi obligatorio.
	  \item Desarrollo Web: debido a la poca uniformidad de la información que se encuentra en Internet; aun cuando también puede emplearse SQL.
  \item Desarrollo Móvil: debido a la tendencia – en crecimiento- de \href{https://es.wikipedia.org/wiki/Bring_your_own_device
}{Bring Your Own Device}.
  \item BigData: debido a la administración de grandísimas cantidades de información y su evidente heterogeneidad.
  \item Cloud (XaaS): \textit{Everything as a service}. NoSQL puede adaptarse casi a cualquier necesidad del cliente, y sus particularidades varias.
    \end{itemize}
   
    Como ya he comentado anteriormente las elecciones son personales por lo que unas tecnologías no son ni mejores ni peores que las demás simplemente he tenido que decidir entre las alternativas de las que disponía en el mercado. En el caso de las bases de datos hay que tener claro qué y cómo se quiere almacenar y qué tipo de tecnologías se van a usar en, por ejemplo, la parte del cliente, para elegir que tipo de base de datos emplear, todas tienen sus ventajas e inconvenientes. Si bien es cierto que quizás MongoDB como base de datos haya sido ideal para este tipo de proyecto.

  \section{Metodologías}\label{metodologia}

En cuanto a las metodologías, ya nombradas en apartados anteriores, se eligió una metología \emph{Scrum} para la parte más técnica y la metodología \emph{Lean start-up} para la parte más de empresa, de ésta última veremos más información en los anexos.

Scrum es un tipo de metología ágil que se aplica a grandes proyectos para cumplir las necesidades específicas de una manera estructurada y sistematizada. Entre las ventajas se encuentran la productividad, calidad y que se realiza un seguimiento regular de los avances del proyecto, logrando que los integrantes estén unidos, comunicados y que el cliente vaya viendo los avances. Lógicamente esta metodología no es posible aplicar al cien por cien en el proyecto ya que muchas de las características que posee están destinadas al trabajo en grupo, pero se ha intentado seguir una línea lo más semejante posible. 


\imagen{scrumschema}{Esquema Scrum. Fuente: \url{linkedin/pulse/posts/costa-ruitiago}.}
 
 De una manera más o menos frecuente se siguió una estrategia de desarrollo incremental a través de iteracciones (\emph{sprints)} englobadas en diferentes \emph{milestones}. Al finalizar cada sprint se evaluaba lo realizado y, si era necesario, se realizaba una reunión con el tutor para esclarecer los pasos dados. Las tareas se estimaban en papel, ya que he utilizado un cuaderno en el que anotaba lo que iba aprendiendo y lo que iba realizando, además de los  \emph{boards} de Zenhub. 
 
   \section{Desarrollo del algoritmo}\label{algoritmo}
   El algoritmo que he usado para realizar el cambio de turno entre los usuarios es bastante sencillo y no muy complejo de entender.
   
   Lo primero que hay que comprender es cómo funciona internamente la base de datos dado que va a ser la parte fundamental para que se produzca el intercambio deseado. \emph{MongoDB} como ya sabemos  se basa en colecciones de datos, por lo tanto para mi proyecto yo poseo una base de datos que consta de las siguiente colecciones:
   
   
   \begin{itemize}
	\item Users (Usuarios): es simplemente una colección para almacenar usuarios con los parámetros deseados, creada a partir de los cursos que he realizado.
	\item Event (Eventos): es la colección que proporciona el calendario escogido, es decir, se utiliza para almacenar cada uno de los eventos, en este caso turnos, que se añaden al calendario.
	\item Interchange (Intercambio): es una colección extra que se ha añadido para intercambiar entre los usuarios el turno
	\end{itemize}
   
   \imagen{dbschema}{Esquema interno base de datos. Fuente: Elaboración propia.}
   
   Una vez entendido esto voy a explicar de una manera didáctica como se consigue el intercambio de turnos. Cada usuario posee su propio calendario, cada uno puede añadir sus propios turnos al calendario pero no ver los de los demás, los turnos son de cuatro tipos, se detallarán a continuación \ref{img:shiftschema}, y los cambios solo se producen entre tipos de turnos específicos. 

 \imagen{shiftschema}{Esquema  tipos de turnos. Elaboración propia.}\label{img:shiftschema}
 
Cada turno tiene asignada una prioridad que por defecto será  \textbf{normal}. Existen varios tipo de prioridades que se asignarán dependiendo en qué fase se encuentra ese turno, es decir, cuando un usuario solicita un turno cambiará de prioridad porque debe esperar hasta que el otro usuario acepte o rechace la petición. Por lo tanto se trata de una lógica que funciona a base de peticiones-respuesta. Cuando varios usuarios, de una misma empresa, puedan intercambiar sus turnos de acuerdo a la lógica de la imagen \ref{img:shiftschema} entonces entran en juego las prioridades ya nombradas.  

\imagen{prioritiesscchema}{Esquema de las diferentes prioridades. Fuente: Elaboración propia.}
 
 Todos los turnos, llamados \emph{eventos} dentro del código interno del calendario, poseen prioridad \textbf{normal}, cuando un usuario pregunta a otro por el cambio de turno, automáticamente el turno del \underline{usuario emisor} pasa \textbf{required}, o requerido, y el turno del \underline{usuario destinatario} a \textbf{pending}, o pendiente. Por lo que una vez se llega hasta aquí es el usuario destinatario el que tiene el poder de decisión, deberá aceptar o rechazar la petición. En función de lo que este usuario decida ese turno pasará a ser \textbf{accepted} o \textbf{declined}. Si el usuario que recibe la petición lo acepta se producirá el cambio de turno, si lo rechaza no se producirá el cambio y el turno pasará a estado normal.
 
 Asimismo es necesario, debido a cómo se comporta la base de datos internamente, evitar que se produzcan tareas simultáneas en el calendario. \emph{Angular 2+} proporciona un mecanismo interno para realizar tareas simultáneas pero he considerado oportuno el separar cada proceso en un mecanismo diferente de manera que el usuario tiene claro en cada momento: los usuarios a los que puede enviar una petición (de la misma manera el usuario que la recibe tiene constancia), si esa petición de cambio ha sido acepta o rechazada y por último confirmar ese cambio o rechazo. De esta manera estamos garantizando al cien por cien que el usuario ha sido informado sobre si su petición ha sido aceptada o rechazada y evitando posibles engaños por parte de los usuarios.
 
 Por otro lado hay que notar que la colección \emph{Interchange} empleada para realizar y almacenar el cambio de turno, puede resultar muy útil en el futuro para implementar, de alguna manera una forma de que el usuario pueda ver una lista de las peticiones de cambio de turno rechazadas o aceptadas en el pasado. En un primer momento se pensó en borrar la información de cada intercambio pero si se piensa un poco más se puede llegar a la conclusión de que estos datos pueden resultan realmente interesantes para, por ejemplo, un administrador del sitio. 
 

   
   \section{Desarrollo web}\label{dweb}
   
   El desarrollo de la aplicación web se ha realizado de manera progresiva aunque durante varias fases, la primera en 
   
   \section{Desarrollo móvil}\label{dapp}
   
   El desarrollo móvil ha sido la última parte
   
   \section{Documentación}\label{docs}
   
   La documentación se ha realizado de manera progresiva siempre que se podía se añadían partes de la misma. 
   

   
   \section{Reconocimientos}\label{reconocimientos}
   
   Reconocimientos durante el desarrollo:
   
   \begin{itemize}
	\item YUZZ: BarterAPP fue elegida para participar en el programa YUZZ 2017, patrocinado por el Banco Santander-Universidades, se trata de un programa de formación que se extiende de enero a junio en el que se aprenden materias como marketing, financiación, puesta en marcha de un proyecto o análisis de mercados entre muchas otras cosas. 
	\item ANGULAR CAMP: Quizás no sea un reconocimiento en sí mismo del proyecto pero teniendo en cuenta que hace seis meses no tenía ni idea de Angular, he sido seleccionado, tras una entrevista previa, para formar parte del  \href{https://angularcamp.org/}{Angular Camp} que se desarrolla en la ciudad de Barcelona durante los días 6 y 7 de julio.
\end{itemize}


\section{Agradecimientos}\label{reconocimientos}
\begin{itemize}
		\item Alberto Basalo
		\item TFG
		\item Davide Violante
		\item A todo el equipo de nanobox
\end{itemize}


 
 